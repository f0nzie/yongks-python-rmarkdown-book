<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>16 sklearn | Python Bookdown</title>
<meta name="author" content="Yong Keh Soon">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Python Bookdown</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li><a class="" href="fundamentals.html"><span class="header-section-number">1</span> Fundamentals</a></li>
<li><a class="" href="built-in-data-types.html"><span class="header-section-number">2</span> Built-in Data Types</a></li>
<li><a class="" href="built-in-data-structure.html"><span class="header-section-number">3</span> Built-In Data Structure</a></li>
<li><a class="" href="control-and-loops.html"><span class="header-section-number">4</span> Control and Loops</a></li>
<li><a class="" href="library-and-functions.html"><span class="header-section-number">5</span> Library and Functions</a></li>
<li><a class="" href="exception-handling.html"><span class="header-section-number">6</span> Exception Handling</a></li>
<li><a class="" href="object-oriented-programming.html"><span class="header-section-number">7</span> Object Oriented Programming</a></li>
<li><a class="" href="decorator.html"><span class="header-section-number">8</span> Decorator</a></li>
<li><a class="" href="datetime-standard-library.html"><span class="header-section-number">9</span> datetime Standard Library</a></li>
<li><a class="" href="getting-external-data.html"><span class="header-section-number">10</span> Getting External Data</a></li>
<li><a class="" href="plydata-dplyr-for-python.html"><span class="header-section-number">11</span> Plydata (dplyr for Python)</a></li>
<li><a class="" href="numpy-1.html"><span class="header-section-number">12</span> numpy</a></li>
<li><a class="" href="pandas-1.html"><span class="header-section-number">13</span> pandas</a></li>
<li><a class="" href="matplotlib-1.html"><span class="header-section-number">14</span> matplotlib</a></li>
<li><a class="" href="seaborn.html"><span class="header-section-number">15</span> seaborn</a></li>
<li><a class="active" href="sklearn.html"><span class="header-section-number">16</span> sklearn</a></li>
<li><a class="" href="nlp.html"><span class="header-section-number">17</span> NLP</a></li>
<li><a class="" href="web-scrapping.html"><span class="header-section-number">18</span> Web Scrapping</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com//f0nzie/yongks-python-rmarkdown-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="sklearn" class="section level1" number="16">
<h1>
<span class="header-section-number">16</span> sklearn<a class="anchor" aria-label="anchor" href="#sklearn"><i class="fas fa-link"></i></a>
</h1>
<p>This is a machine learning library.</p>
<div id="setup-hidden" class="section level2" number="16.1">
<h2>
<span class="header-section-number">16.1</span> Setup (hidden)<a class="anchor" aria-label="anchor" href="#setup-hidden"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb1564"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1564-1"><a href="sklearn.html#cb1564-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1564-2"><a href="sklearn.html#cb1564-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1564-3"><a href="sklearn.html#cb1564-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1564-4"><a href="sklearn.html#cb1564-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1564-5"><a href="sklearn.html#cb1564-5" aria-hidden="true" tabindex="-1"></a>pd.set_option( <span class="st">'display.notebook_repr_html'</span>, <span class="va">False</span>)  <span class="co"># render Series and DataFrame as text, not HTML</span></span>
<span id="cb1564-6"><a href="sklearn.html#cb1564-6" aria-hidden="true" tabindex="-1"></a>pd.set_option( <span class="st">'display.max_column'</span>, <span class="dv">10</span>)    <span class="co"># number of columns</span></span>
<span id="cb1564-7"><a href="sklearn.html#cb1564-7" aria-hidden="true" tabindex="-1"></a>pd.set_option( <span class="st">'display.max_rows'</span>, <span class="dv">10</span>)     <span class="co"># number of rows</span></span>
<span id="cb1564-8"><a href="sklearn.html#cb1564-8" aria-hidden="true" tabindex="-1"></a>pd.set_option( <span class="st">'display.width'</span>, <span class="dv">90</span>)        <span class="co"># number of characters per row</span></span></code></pre></div>
</div>
<div id="the-library" class="section level2" number="16.2">
<h2>
<span class="header-section-number">16.2</span> The Library<a class="anchor" aria-label="anchor" href="#the-library"><i class="fas fa-link"></i></a>
</h2>
<p>sklearn <strong>does not automatically import its subpackages</strong>. Therefore all subpakcages must be specifically loaded before use.</p>
<div class="sourceCode" id="cb1565"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1565-1"><a href="sklearn.html#cb1565-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample Data</span></span>
<span id="cb1565-2"><a href="sklearn.html#cb1565-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn                 <span class="im">import</span> datasets</span>
<span id="cb1565-3"><a href="sklearn.html#cb1565-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1565-4"><a href="sklearn.html#cb1565-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Selection</span></span>
<span id="cb1565-5"><a href="sklearn.html#cb1565-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1565-6"><a href="sklearn.html#cb1565-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold</span>
<span id="cb1565-7"><a href="sklearn.html#cb1565-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> LeaveOneOut</span>
<span id="cb1565-8"><a href="sklearn.html#cb1565-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_validate</span>
<span id="cb1565-9"><a href="sklearn.html#cb1565-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1565-10"><a href="sklearn.html#cb1565-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocessing</span></span>
<span id="cb1565-11"><a href="sklearn.html#cb1565-11" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.preprocessing   import Imputer</span></span>
<span id="cb1565-12"><a href="sklearn.html#cb1565-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb1565-13"><a href="sklearn.html#cb1565-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1565-14"><a href="sklearn.html#cb1565-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> MinMaxScaler</span>
<span id="cb1565-15"><a href="sklearn.html#cb1565-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> StandardScaler</span>
<span id="cb1565-16"><a href="sklearn.html#cb1565-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> Normalizer</span>
<span id="cb1565-17"><a href="sklearn.html#cb1565-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing   <span class="im">import</span> PolynomialFeatures</span>
<span id="cb1565-18"><a href="sklearn.html#cb1565-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1565-19"><a href="sklearn.html#cb1565-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Model and Pipeline</span></span>
<span id="cb1565-20"><a href="sklearn.html#cb1565-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model    <span class="im">import</span> LinearRegression,Lasso</span>
<span id="cb1565-21"><a href="sklearn.html#cb1565-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline        <span class="im">import</span> make_pipeline</span>
<span id="cb1565-22"><a href="sklearn.html#cb1565-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1565-23"><a href="sklearn.html#cb1565-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Measurement</span></span>
<span id="cb1565-24"><a href="sklearn.html#cb1565-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics         <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1565-25"><a href="sklearn.html#cb1565-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1565-26"><a href="sklearn.html#cb1565-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span></code></pre></div>
</div>
<div id="model-fitting" class="section level2" number="16.3">
<h2>
<span class="header-section-number">16.3</span> Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<img src="img/fitting.png" alt=""><p class="caption">split</p>
</div>
<div id="underfitting" class="section level3" number="16.3.1">
<h3>
<span class="header-section-number">16.3.1</span> Underfitting<a class="anchor" aria-label="anchor" href="#underfitting"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>The model does not fit the training data and therefore misses the trends in the data</li>
<li>The model cannot be generalized to new data, this is usually the result of a very simple model (not enough predictors/independent variables)</li>
<li>The model will have poor predictive ability</li>
<li>For example, we fit a linear model (like linear regression) to data that is not linear</li>
</ul>
</div>
<div id="overfitting" class="section level3" number="16.3.2">
<h3>
<span class="header-section-number">16.3.2</span> Overfitting<a class="anchor" aria-label="anchor" href="#overfitting"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>The model has trained ?too well? and is now, well, fit too closely to the training dataset</li>
<li>The model is too complex (i.e. <strong>too many features/variables</strong> compared to the number of observations)</li>
<li>The model will be very accurate on the training data but will probably be very not accurate on untrained or new data</li>
<li>The model is not generalized (or not AS generalized), meaning you can generalize the results</li>
<li>The model learns or describes the ?noise? in the training data instead of the actual relationships between variables in the data</li>
</ul>
</div>
<div id="just-right" class="section level3" number="16.3.3">
<h3>
<span class="header-section-number">16.3.3</span> Just Right<a class="anchor" aria-label="anchor" href="#just-right"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>It is worth noting the underfitting is not as prevalent as overfitting</li>
<li>Nevertheless, we want to avoid both of those problems in data analysis</li>
<li>We want to find the middle ground between under and overfitting our model</li>
</ul>
</div>
</div>
<div id="model-tuning" class="section level2" number="16.4">
<h2>
<span class="header-section-number">16.4</span> Model Tuning<a class="anchor" aria-label="anchor" href="#model-tuning"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>A highly complex model tend to overfit</li>
<li>A too flexible model tend to underfit</li>
</ul>
<p>Complexity can be reduced by:
- Less features
- Less degree of polynomial features
- Apply generalization (tuning hyperparameters)</p>
<div class="figure">
<img src="img/model_complexity.jpg" alt=""><p class="caption">split</p>
</div>
</div>
<div id="high-level-ml-process" class="section level2" number="16.5">
<h2>
<span class="header-section-number">16.5</span> High Level ML Process<a class="anchor" aria-label="anchor" href="#high-level-ml-process"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<img src="img/scikit_learn_split.jpg" alt=""><p class="caption">split</p>
</div>
</div>
<div id="built-in-datasets" class="section level2" number="16.6">
<h2>
<span class="header-section-number">16.6</span> Built-in Datasets<a class="anchor" aria-label="anchor" href="#built-in-datasets"><i class="fas fa-link"></i></a>
</h2>
<p>sklearn included some popular datasets to play with<br>
Each dataset is of type <strong>Bunch</strong>.<br>
It has useful data (array) in the form of properties:<br>
- keys (display all data availabe within the dataset)<br>
- data (common)<br>
- target (common)<br>
- DESCR (common)
- feature_names (some dataset)<br>
- target_names (some dataset)
- images (some dataset)</p>
<div id="diabetes-regression" class="section level3" number="16.6.1">
<h3>
<span class="header-section-number">16.6.1</span> diabetes (regression)<a class="anchor" aria-label="anchor" href="#diabetes-regression"><i class="fas fa-link"></i></a>
</h3>
<div id="load-dataset" class="section level4" number="16.6.1.1">
<h4>
<span class="header-section-number">16.6.1.1</span> Load Dataset<a class="anchor" aria-label="anchor" href="#load-dataset"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1566"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1566-1"><a href="sklearn.html#cb1566-1" aria-hidden="true" tabindex="-1"></a>diabetes <span class="op">=</span> datasets.load_diabetes()</span>
<span id="cb1566-2"><a href="sklearn.html#cb1566-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">type</span>(diabetes))</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'sklearn.utils.Bunch'&gt;</code></pre>
</div>
<div id="keys" class="section level4" number="16.6.1.2">
<h4>
<span class="header-section-number">16.6.1.2</span> keys<a class="anchor" aria-label="anchor" href="#keys"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1568"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1568-1"><a href="sklearn.html#cb1568-1" aria-hidden="true" tabindex="-1"></a>diabetes.keys()</span></code></pre></div>
<pre><code>#:&gt; dict_keys(['data', 'target', 'frame', 'DESCR', 'feature_names', 'data_filename', 'target_filename'])</code></pre>
</div>
<div id="features-and-target" class="section level4" number="16.6.1.3">
<h4>
<span class="header-section-number">16.6.1.3</span> Features and Target<a class="anchor" aria-label="anchor" href="#features-and-target"><i class="fas fa-link"></i></a>
</h4>
<p>.data = features - two dimension array<br>
.target = target - one dimension array</p>
<div class="sourceCode" id="cb1570"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1570-1"><a href="sklearn.html#cb1570-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">type</span>(diabetes.data))</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'numpy.ndarray'&gt;</code></pre>
<div class="sourceCode" id="cb1572"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1572-1"><a href="sklearn.html#cb1572-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">type</span>(diabetes.target))</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'numpy.ndarray'&gt;</code></pre>
<div class="sourceCode" id="cb1574"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1574-1"><a href="sklearn.html#cb1574-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (diabetes.data.shape)</span></code></pre></div>
<pre><code>#:&gt; (442, 10)</code></pre>
<div class="sourceCode" id="cb1576"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1576-1"><a href="sklearn.html#cb1576-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (diabetes.target.shape)</span></code></pre></div>
<pre><code>#:&gt; (442,)</code></pre>
</div>
<div id="load-with-xy-convenient-method" class="section level4" number="16.6.1.4">
<h4>
<span class="header-section-number">16.6.1.4</span> Load with X,y (Convenient Method)<a class="anchor" aria-label="anchor" href="#load-with-xy-convenient-method"><i class="fas fa-link"></i></a>
</h4>
<p>using return_X_y = True, data is loaded into X, target is loaded into y</p>
<div class="sourceCode" id="cb1578"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1578-1"><a href="sklearn.html#cb1578-1" aria-hidden="true" tabindex="-1"></a>X,y      <span class="op">=</span> datasets.load_diabetes(return_X_y<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1579"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1579-1"><a href="sklearn.html#cb1579-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (X.shape)</span></code></pre></div>
<pre><code>#:&gt; (442, 10)</code></pre>
<div class="sourceCode" id="cb1581"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1581-1"><a href="sklearn.html#cb1581-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (y.shape)</span></code></pre></div>
<pre><code>#:&gt; (442,)</code></pre>
</div>
</div>
<div id="digits-classification" class="section level3" number="16.6.2">
<h3>
<span class="header-section-number">16.6.2</span> digits (Classification)<a class="anchor" aria-label="anchor" href="#digits-classification"><i class="fas fa-link"></i></a>
</h3>
<p>This is a copy of the test set of the UCI ML hand-written digits datasets</p>
<div class="sourceCode" id="cb1583"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1583-1"><a href="sklearn.html#cb1583-1" aria-hidden="true" tabindex="-1"></a>digits <span class="op">=</span> datasets.load_digits()</span>
<span id="cb1583-2"><a href="sklearn.html#cb1583-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">type</span>(digits))</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'sklearn.utils.Bunch'&gt;</code></pre>
<div class="sourceCode" id="cb1585"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1585-1"><a href="sklearn.html#cb1585-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">type</span>(digits.data))</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'numpy.ndarray'&gt;</code></pre>
<div class="sourceCode" id="cb1587"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1587-1"><a href="sklearn.html#cb1587-1" aria-hidden="true" tabindex="-1"></a>digits.keys()</span></code></pre></div>
<pre><code>#:&gt; dict_keys(['data', 'target', 'frame', 'feature_names', 'target_names', 'images', 'DESCR'])</code></pre>
<div class="sourceCode" id="cb1589"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1589-1"><a href="sklearn.html#cb1589-1" aria-hidden="true" tabindex="-1"></a>digits.target_names</span></code></pre></div>
<pre><code>#:&gt; array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
<div id="data" class="section level4" number="16.6.2.1">
<h4>
<span class="header-section-number">16.6.2.1</span> data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1591"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1591-1"><a href="sklearn.html#cb1591-1" aria-hidden="true" tabindex="-1"></a>digits.data.shape  <span class="co"># features</span></span></code></pre></div>
<pre><code>#:&gt; (1797, 64)</code></pre>
<div class="sourceCode" id="cb1593"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1593-1"><a href="sklearn.html#cb1593-1" aria-hidden="true" tabindex="-1"></a>digits.target.shape <span class="co"># target</span></span></code></pre></div>
<pre><code>#:&gt; (1797,)</code></pre>
</div>
<div id="images" class="section level4" number="16.6.2.2">
<h4>
<span class="header-section-number">16.6.2.2</span> Images<a class="anchor" aria-label="anchor" href="#images"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>images is 3 dimensional array<br>
</li>
<li>There are <strong>1797 samples</strong>, each sample is <strong>8x8 pixels</strong>
</li>
</ul>
<div class="sourceCode" id="cb1595"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1595-1"><a href="sklearn.html#cb1595-1" aria-hidden="true" tabindex="-1"></a>digits.images.shape</span></code></pre></div>
<pre><code>#:&gt; (1797, 8, 8)</code></pre>
<div class="sourceCode" id="cb1597"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1597-1"><a href="sklearn.html#cb1597-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(digits.images)</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'numpy.ndarray'&gt;</code></pre>
<p><strong>Each element represent the data that make its target</strong></p>
<div class="sourceCode" id="cb1599"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1599-1"><a href="sklearn.html#cb1599-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (digits.target[<span class="dv">100</span>])</span></code></pre></div>
<pre><code>#:&gt; 4</code></pre>
<div class="sourceCode" id="cb1601"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1601-1"><a href="sklearn.html#cb1601-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (digits.images[<span class="dv">100</span>])</span></code></pre></div>
<pre><code>#:&gt; [[ 0.  0.  0.  2. 13.  0.  0.  0.]
#:&gt;  [ 0.  0.  0.  8. 15.  0.  0.  0.]
#:&gt;  [ 0.  0.  5. 16.  5.  2.  0.  0.]
#:&gt;  [ 0.  0. 15. 12.  1. 16.  4.  0.]
#:&gt;  [ 0.  4. 16.  2.  9. 16.  8.  0.]
#:&gt;  [ 0.  0. 10. 14. 16. 16.  4.  0.]
#:&gt;  [ 0.  0.  0.  0. 13.  8.  0.  0.]
#:&gt;  [ 0.  0.  0.  0. 13.  6.  0.  0.]]</code></pre>
<div class="sourceCode" id="cb1603"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1603-1"><a href="sklearn.html#cb1603-1" aria-hidden="true" tabindex="-1"></a>plt.matshow(digits.images[<span class="dv">100</span>]) </span></code></pre></div>
<div class="inline-figure"><img src="05-sklearn_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="loading-into-xy-convenient-method" class="section level4" number="16.6.2.3">
<h4>
<span class="header-section-number">16.6.2.3</span> Loading Into X,y (Convenient Method)<a class="anchor" aria-label="anchor" href="#loading-into-xy-convenient-method"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1604"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1604-1"><a href="sklearn.html#cb1604-1" aria-hidden="true" tabindex="-1"></a>X,y <span class="op">=</span> datasets.load_digits(return_X_y<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1605"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1605-1"><a href="sklearn.html#cb1605-1" aria-hidden="true" tabindex="-1"></a>X.shape</span></code></pre></div>
<pre><code>#:&gt; (1797, 64)</code></pre>
<div class="sourceCode" id="cb1607"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1607-1"><a href="sklearn.html#cb1607-1" aria-hidden="true" tabindex="-1"></a>y.shape</span></code></pre></div>
<pre><code>#:&gt; (1797,)</code></pre>
</div>
</div>
<div id="iris-classification" class="section level3" number="16.6.3">
<h3>
<span class="header-section-number">16.6.3</span> iris (Classification)<a class="anchor" aria-label="anchor" href="#iris-classification"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1609"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1609-1"><a href="sklearn.html#cb1609-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> datasets.load_iris()</span></code></pre></div>
<div class="sourceCode" id="cb1610"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1610-1"><a href="sklearn.html#cb1610-1" aria-hidden="true" tabindex="-1"></a>iris.keys()</span></code></pre></div>
<pre><code>#:&gt; dict_keys(['data', 'target', 'frame', 'target_names', 'DESCR', 'feature_names', 'filename'])</code></pre>
<div id="feature-names" class="section level4" number="16.6.3.1">
<h4>
<span class="header-section-number">16.6.3.1</span> Feature Names<a class="anchor" aria-label="anchor" href="#feature-names"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1612"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1612-1"><a href="sklearn.html#cb1612-1" aria-hidden="true" tabindex="-1"></a>iris.feature_names</span></code></pre></div>
<pre><code>#:&gt; ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']</code></pre>
</div>
<div id="target" class="section level4" number="16.6.3.2">
<h4>
<span class="header-section-number">16.6.3.2</span> target<a class="anchor" aria-label="anchor" href="#target"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1614"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1614-1"><a href="sklearn.html#cb1614-1" aria-hidden="true" tabindex="-1"></a>iris.target_names</span></code></pre></div>
<pre><code>#:&gt; array(['setosa', 'versicolor', 'virginica'], dtype='&lt;U10')</code></pre>
<div class="sourceCode" id="cb1616"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1616-1"><a href="sklearn.html#cb1616-1" aria-hidden="true" tabindex="-1"></a>iris.target</span></code></pre></div>
<pre><code>#:&gt; array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
#:&gt;        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
#:&gt;        0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
#:&gt;        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
#:&gt;        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
#:&gt;        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
#:&gt;        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])</code></pre>
</div>
</div>
</div>
<div id="train-test-data-splitting" class="section level2" number="16.7">
<h2>
<span class="header-section-number">16.7</span> Train Test Data Splitting<a class="anchor" aria-label="anchor" href="#train-test-data-splitting"><i class="fas fa-link"></i></a>
</h2>
<div id="sample-data-20" class="section level3" number="16.7.1">
<h3>
<span class="header-section-number">16.7.1</span> Sample Data<a class="anchor" aria-label="anchor" href="#sample-data-20"><i class="fas fa-link"></i></a>
</h3>
<p>Generate 100 rows of data, with 3x features (X1,X2,X3), and one dependant variable (Y)</p>
<div class="sourceCode" id="cb1618"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1618-1"><a href="sklearn.html#cb1618-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">21</span>  <span class="co"># number of samples</span></span>
<span id="cb1618-2"><a href="sklearn.html#cb1618-2" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> <span class="dv">5</span>  <span class="co"># intercept value</span></span>
<span id="cb1618-3"><a href="sklearn.html#cb1618-3" aria-hidden="true" tabindex="-1"></a>E <span class="op">=</span> np.random.randint( <span class="dv">1</span>,<span class="dv">20</span>, n)  <span class="co"># Error</span></span>
<span id="cb1618-4"><a href="sklearn.html#cb1618-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.random.randint( <span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>, n)</span>
<span id="cb1618-5"><a href="sklearn.html#cb1618-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.random.randint( <span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>, n)</span>
<span id="cb1618-6"><a href="sklearn.html#cb1618-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="op">=</span> np.random.randint( <span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>, n)</span>
<span id="cb1618-7"><a href="sklearn.html#cb1618-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span>x1 <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span>x3 <span class="op">+</span> E <span class="op">+</span> I</span>
<span id="cb1618-8"><a href="sklearn.html#cb1618-8" aria-hidden="true" tabindex="-1"></a>mydf <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1618-9"><a href="sklearn.html#cb1618-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'y'</span>:y,</span>
<span id="cb1618-10"><a href="sklearn.html#cb1618-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'x1'</span>:x1,</span>
<span id="cb1618-11"><a href="sklearn.html#cb1618-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'x2'</span>:x2,</span>
<span id="cb1618-12"><a href="sklearn.html#cb1618-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'x3'</span>:x3</span>
<span id="cb1618-13"><a href="sklearn.html#cb1618-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1618-14"><a href="sklearn.html#cb1618-14" aria-hidden="true" tabindex="-1"></a>mydf.shape</span></code></pre></div>
<pre><code>#:&gt; (21, 4)</code></pre>
</div>
<div id="one-time-split" class="section level3" number="16.7.2">
<h3>
<span class="header-section-number">16.7.2</span> One Time Split<a class="anchor" aria-label="anchor" href="#one-time-split"><i class="fas fa-link"></i></a>
</h3>
<p>sklearn::train_test_split() has two forms:
- Take one DF, split into 2 DF (most of sklearn modeling use this method
- Take two DFs, split into 4 DF</p>
<div class="sourceCode" id="cb1620"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1620-1"><a href="sklearn.html#cb1620-1" aria-hidden="true" tabindex="-1"></a>mydf.head()</span></code></pre></div>
<pre><code>#:&gt;       y  x1  x2  x3
#:&gt; 0  28.2   4  17   8
#:&gt; 1  19.8   3  12   7
#:&gt; 2  18.4  10  10   8
#:&gt; 3  20.0  20  18   8
#:&gt; 4  19.4  20   6  14</code></pre>
<div id="method-1-split-one-dataframe-into-two-train-test" class="section level4" number="16.7.2.1">
<h4>
<span class="header-section-number">16.7.2.1</span> Method 1: Split One Dataframe Into Two (Train &amp; Test)<a class="anchor" aria-label="anchor" href="#method-1-split-one-dataframe-into-two-train-test"><i class="fas fa-link"></i></a>
</h4>
<pre><code>traindf, testdf = train_test_split( df, test_size=, random_state= ) 
 # random_state : seed number (integer), optional
 # test_size    : fraction of 1, 0.2 means 20%</code></pre>
<div class="figure">
<img src="img/train_test_split_1.jpg" alt=""><p class="caption">split</p>
</div>
<div class="sourceCode" id="cb1623"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1623-1"><a href="sklearn.html#cb1623-1" aria-hidden="true" tabindex="-1"></a>traindf, testdf <span class="op">=</span> train_test_split(mydf,test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">25</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1624"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1624-1"><a href="sklearn.html#cb1624-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">len</span>(traindf))</span></code></pre></div>
<pre><code>#:&gt; 16</code></pre>
<div class="sourceCode" id="cb1626"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1626-1"><a href="sklearn.html#cb1626-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">len</span>(testdf))</span></code></pre></div>
<pre><code>#:&gt; 5</code></pre>
</div>
<div id="method-2-split-two-dataframe-xy-into-four-x_traintest-y_traintest" class="section level4" number="16.7.2.2">
<h4>
<span class="header-section-number">16.7.2.2</span> Method 2: Split Two DataFrame (X,Y) into Four x_train/test, y_train/test<a class="anchor" aria-label="anchor" href="#method-2-split-two-dataframe-xy-into-four-x_traintest-y_traintest"><i class="fas fa-link"></i></a>
</h4>
<pre><code>x_train, x_test, y_train, y_test = train_test_split( X,Y, test_size=, random_state= )
 # random_state : seed number (integer), optional
 # test_size    : fraction of 1, 0.2 means 20%</code></pre>
<div class="figure">
<img src="img/train_test_split_2.jpg" alt=""><p class="caption">split</p>
</div>
<p><strong>Split DataFrame into X and Y First</strong></p>
<div class="sourceCode" id="cb1629"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1629-1"><a href="sklearn.html#cb1629-1" aria-hidden="true" tabindex="-1"></a>feature_cols <span class="op">=</span> [<span class="st">'x1'</span>,<span class="st">'x2'</span>,<span class="st">'x3'</span>]</span>
<span id="cb1629-2"><a href="sklearn.html#cb1629-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> mydf[feature_cols]</span>
<span id="cb1629-3"><a href="sklearn.html#cb1629-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> mydf.y</span></code></pre></div>
<p><strong>Then Split X/Y into x_train/test, y_train/test</strong></p>
<div class="sourceCode" id="cb1630"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1630-1"><a href="sklearn.html#cb1630-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split( X,Y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb1630-2"><a href="sklearn.html#cb1630-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">len</span>(x_train))</span></code></pre></div>
<pre><code>#:&gt; 16</code></pre>
<div class="sourceCode" id="cb1632"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1632-1"><a href="sklearn.html#cb1632-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">len</span>(x_test))</span></code></pre></div>
<pre><code>#:&gt; 5</code></pre>
</div>
</div>
<div id="k-fold" class="section level3" number="16.7.3">
<h3>
<span class="header-section-number">16.7.3</span> K-Fold<a class="anchor" aria-label="anchor" href="#k-fold"><i class="fas fa-link"></i></a>
</h3>
<pre><code>KFold(n_splits=3, shuffle=False, random_state=None)</code></pre>
<div class="figure">
<img src="img/kfold.jpg" alt=""><p class="caption">split</p>
</div>
<p><strong>suffle=False</strong> (default), meaning index number is taken continously</p>
<div class="sourceCode" id="cb1635"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1635-1"><a href="sklearn.html#cb1635-1" aria-hidden="true" tabindex="-1"></a>kf <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">7</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1636"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1636-1"><a href="sklearn.html#cb1636-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> train_index, test_index <span class="kw">in</span> kf.split(X):</span>
<span id="cb1636-2"><a href="sklearn.html#cb1636-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (train_index, test_index)</span></code></pre></div>
<pre><code>#:&gt; [ 3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [0 1 2]
#:&gt; [ 0  1  2  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [3 4 5]
#:&gt; [ 0  1  2  3  4  5  9 10 11 12 13 14 15 16 17 18 19 20] [6 7 8]
#:&gt; [ 0  1  2  3  4  5  6  7  8 12 13 14 15 16 17 18 19 20] [ 9 10 11]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 15 16 17 18 19 20] [12 13 14]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 18 19 20] [15 16 17]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17] [18 19 20]</code></pre>
<p><strong>shuffle=True</strong></p>
<div class="sourceCode" id="cb1638"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1638-1"><a href="sklearn.html#cb1638-1" aria-hidden="true" tabindex="-1"></a>kf <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">7</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1639"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1639-1"><a href="sklearn.html#cb1639-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> train_index, test_index <span class="kw">in</span> kf.split(X):</span>
<span id="cb1639-2"><a href="sklearn.html#cb1639-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (train_index, test_index)</span></code></pre></div>
<pre><code>#:&gt; [ 0  1  2  3  4  5  7  8  9 10 11 12 13 15 16 17 18 19] [ 6 14 20]
#:&gt; [ 0  1  2  3  4  5  6  8 10 11 12 13 14 16 17 18 19 20] [ 7  9 15]
#:&gt; [ 0  2  3  4  5  6  7  8  9 10 11 12 14 15 16 17 19 20] [ 1 13 18]
#:&gt; [ 0  1  2  3  4  5  6  7  9 10 13 14 15 16 17 18 19 20] [ 8 11 12]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 11 12 13 14 15 18 19 20] [10 16 17]
#:&gt; [ 1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 20] [ 0  4 19]
#:&gt; [ 0  1  4  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [2 3 5]</code></pre>
</div>
<div id="leave-one-out" class="section level3" number="16.7.4">
<h3>
<span class="header-section-number">16.7.4</span> Leave One Out<a class="anchor" aria-label="anchor" href="#leave-one-out"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>For a dataset of N rows, Leave One Out will split N-1 times, each time leaving one row as test, remaning as training set.<br>
</li>
<li>Due to the <strong>high number of test sets</strong> (which is the same as the number of samples-1) this cross-validation method can be very costly. For large datasets one should favor KFold.</li>
</ul>
<div class="sourceCode" id="cb1641"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1641-1"><a href="sklearn.html#cb1641-1" aria-hidden="true" tabindex="-1"></a>loo <span class="op">=</span> LeaveOneOut()</span></code></pre></div>
<div class="sourceCode" id="cb1642"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1642-1"><a href="sklearn.html#cb1642-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> train_index, test_index <span class="kw">in</span> loo.split(X):</span>
<span id="cb1642-2"><a href="sklearn.html#cb1642-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (train_index, test_index)</span></code></pre></div>
<pre><code>#:&gt; [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [0]
#:&gt; [ 0  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [1]
#:&gt; [ 0  1  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [2]
#:&gt; [ 0  1  2  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [3]
#:&gt; [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [4]
#:&gt; [ 0  1  2  3  4  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [5]
#:&gt; [ 0  1  2  3  4  5  7  8  9 10 11 12 13 14 15 16 17 18 19 20] [6]
#:&gt; [ 0  1  2  3  4  5  6  8  9 10 11 12 13 14 15 16 17 18 19 20] [7]
#:&gt; [ 0  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20] [8]
#:&gt; [ 0  1  2  3  4  5  6  7  8 10 11 12 13 14 15 16 17 18 19 20] [9]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 11 12 13 14 15 16 17 18 19 20] [10]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 12 13 14 15 16 17 18 19 20] [11]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 13 14 15 16 17 18 19 20] [12]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 14 15 16 17 18 19 20] [13]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 15 16 17 18 19 20] [14]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 16 17 18 19 20] [15]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 17 18 19 20] [16]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 18 19 20] [17]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 19 20] [18]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 20] [19]
#:&gt; [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] [20]</code></pre>
<div class="sourceCode" id="cb1644"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1644-1"><a href="sklearn.html#cb1644-1" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>#:&gt;     x1  x2  x3
#:&gt; 0    4  17   8
#:&gt; 1    3  12   7
#:&gt; 2   10  10   8
#:&gt; 3   20  18   8
#:&gt; 4   20   6  14
#:&gt; ..  ..  ..  ..
#:&gt; 16  17   5  10
#:&gt; 17  10  16  12
#:&gt; 18   3  12   1
#:&gt; 19   3   3   5
#:&gt; 20   2   8   5
#:&gt; 
#:&gt; [21 rows x 3 columns]</code></pre>
</div>
</div>
<div id="polynomial-transform" class="section level2" number="16.8">
<h2>
<span class="header-section-number">16.8</span> Polynomial Transform<a class="anchor" aria-label="anchor" href="#polynomial-transform"><i class="fas fa-link"></i></a>
</h2>
<p>This can be used as part of feature engineering, to introduce new features for data that seems to fit with quadradic model.</p>
<div id="single-variable" class="section level3" number="16.8.1">
<h3>
<span class="header-section-number">16.8.1</span> Single Variable<a class="anchor" aria-label="anchor" href="#single-variable"><i class="fas fa-link"></i></a>
</h3>
<div id="sample-data-21" class="section level4" number="16.8.1.1">
<h4>
<span class="header-section-number">16.8.1.1</span> Sample Data<a class="anchor" aria-label="anchor" href="#sample-data-21"><i class="fas fa-link"></i></a>
</h4>
<p>Data must be 2-D before polynomial features can be applied. Code below convert 1D array into 2D array.</p>
<div class="sourceCode" id="cb1646"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1646-1"><a href="sklearn.html#cb1646-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb1646-2"><a href="sklearn.html#cb1646-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> x[:,np.newaxis]</span>
<span id="cb1646-3"><a href="sklearn.html#cb1646-3" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>#:&gt; array([[1],
#:&gt;        [2],
#:&gt;        [3],
#:&gt;        [4],
#:&gt;        [5]])</code></pre>
</div>
<div id="degree-1" class="section level4" number="16.8.1.2">
<h4>
<span class="header-section-number">16.8.1.2</span> Degree 1<a class="anchor" aria-label="anchor" href="#degree-1"><i class="fas fa-link"></i></a>
</h4>
<p>One Degree means maintain original features. No new features is created.</p>
<div class="sourceCode" id="cb1648"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1648-1"><a href="sklearn.html#cb1648-1" aria-hidden="true" tabindex="-1"></a>PolynomialFeatures(degree<span class="op">=</span><span class="dv">1</span>, include_bias<span class="op">=</span><span class="va">False</span>).fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[1.],
#:&gt;        [2.],
#:&gt;        [3.],
#:&gt;        [4.],
#:&gt;        [5.]])</code></pre>
</div>
<div id="degree-2" class="section level4" number="16.8.1.3">
<h4>
<span class="header-section-number">16.8.1.3</span> Degree 2<a class="anchor" aria-label="anchor" href="#degree-2"><i class="fas fa-link"></i></a>
</h4>
<p>Degree-1 original feature: x<br>
Degree-2 additional features: x^2</p>
<div class="sourceCode" id="cb1650"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1650-1"><a href="sklearn.html#cb1650-1" aria-hidden="true" tabindex="-1"></a>PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>, include_bias<span class="op">=</span><span class="va">False</span>).fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[ 1.,  1.],
#:&gt;        [ 2.,  4.],
#:&gt;        [ 3.,  9.],
#:&gt;        [ 4., 16.],
#:&gt;        [ 5., 25.]])</code></pre>
</div>
<div id="degree-3" class="section level4" number="16.8.1.4">
<h4>
<span class="header-section-number">16.8.1.4</span> Degree 3<a class="anchor" aria-label="anchor" href="#degree-3"><i class="fas fa-link"></i></a>
</h4>
<p>Degree-1 original feature: x<br>
Degree-2 additional features: x^2<br>
Degree-3 additional features: x^3</p>
<div class="sourceCode" id="cb1652"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1652-1"><a href="sklearn.html#cb1652-1" aria-hidden="true" tabindex="-1"></a>PolynomialFeatures(degree<span class="op">=</span><span class="dv">3</span>, include_bias<span class="op">=</span><span class="va">False</span>).fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[  1.,   1.,   1.],
#:&gt;        [  2.,   4.,   8.],
#:&gt;        [  3.,   9.,  27.],
#:&gt;        [  4.,  16.,  64.],
#:&gt;        [  5.,  25., 125.]])</code></pre>
</div>
<div id="degree-4" class="section level4" number="16.8.1.5">
<h4>
<span class="header-section-number">16.8.1.5</span> Degree 4<a class="anchor" aria-label="anchor" href="#degree-4"><i class="fas fa-link"></i></a>
</h4>
<p>Degree-1 original feature: x<br>
Degree-2 additional features: x^2<br>
Degree-3 additional features: x^3<br>
Degree-3 additional features: x^4</p>
<div class="sourceCode" id="cb1654"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1654-1"><a href="sklearn.html#cb1654-1" aria-hidden="true" tabindex="-1"></a>PolynomialFeatures(degree<span class="op">=</span><span class="dv">4</span>, include_bias<span class="op">=</span><span class="va">False</span>).fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[  1.,   1.,   1.,   1.],
#:&gt;        [  2.,   4.,   8.,  16.],
#:&gt;        [  3.,   9.,  27.,  81.],
#:&gt;        [  4.,  16.,  64., 256.],
#:&gt;        [  5.,  25., 125., 625.]])</code></pre>
</div>
</div>
<div id="two-variables" class="section level3" number="16.8.2">
<h3>
<span class="header-section-number">16.8.2</span> Two Variables<a class="anchor" aria-label="anchor" href="#two-variables"><i class="fas fa-link"></i></a>
</h3>
<div id="sample-data-22" class="section level4" number="16.8.2.1">
<h4>
<span class="header-section-number">16.8.2.1</span> Sample Data<a class="anchor" aria-label="anchor" href="#sample-data-22"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1656"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1656-1"><a href="sklearn.html#cb1656-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.DataFrame( {<span class="st">'x1'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span> ],</span>
<span id="cb1656-2"><a href="sklearn.html#cb1656-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'x2'</span>: [<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]})</span>
<span id="cb1656-3"><a href="sklearn.html#cb1656-3" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>#:&gt;    x1  x2
#:&gt; 0   1   6
#:&gt; 1   2   7
#:&gt; 2   3   8
#:&gt; 3   4   9
#:&gt; 4   5  10</code></pre>
</div>
<div id="degree-2-1" class="section level4" number="16.8.2.2">
<h4>
<span class="header-section-number">16.8.2.2</span> Degree 2<a class="anchor" aria-label="anchor" href="#degree-2-1"><i class="fas fa-link"></i></a>
</h4>
<pre><code>Degree-1 original   features:  x1,     x2  
Degree-2 additional features:  x1^2,   x2^2,   x1:x2 </code></pre>
<div class="sourceCode" id="cb1659"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1659-1"><a href="sklearn.html#cb1659-1" aria-hidden="true" tabindex="-1"></a>PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>, include_bias<span class="op">=</span><span class="va">False</span>).fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[  1.,   6.,   1.,   6.,  36.],
#:&gt;        [  2.,   7.,   4.,  14.,  49.],
#:&gt;        [  3.,   8.,   9.,  24.,  64.],
#:&gt;        [  4.,   9.,  16.,  36.,  81.],
#:&gt;        [  5.,  10.,  25.,  50., 100.]])</code></pre>
</div>
<div id="degree-3-1" class="section level4" number="16.8.2.3">
<h4>
<span class="header-section-number">16.8.2.3</span> Degree 3<a class="anchor" aria-label="anchor" href="#degree-3-1"><i class="fas fa-link"></i></a>
</h4>
<pre><code>Degree-1 original   features:  x1,       x2  
Degree-2 additional features:  x1^2,     x2^2,   x1:x2 
Degree-3 additional features:  x1^3,     x2^3    x1:x2^2    x2:x1^2</code></pre>
<div class="sourceCode" id="cb1662"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1662-1"><a href="sklearn.html#cb1662-1" aria-hidden="true" tabindex="-1"></a>PolynomialFeatures(degree<span class="op">=</span><span class="dv">3</span>, include_bias<span class="op">=</span><span class="va">False</span>).fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[   1.,    6.,    1.,    6.,   36.,    1.,    6.,   36.,  216.],
#:&gt;        [   2.,    7.,    4.,   14.,   49.,    8.,   28.,   98.,  343.],
#:&gt;        [   3.,    8.,    9.,   24.,   64.,   27.,   72.,  192.,  512.],
#:&gt;        [   4.,    9.,   16.,   36.,   81.,   64.,  144.,  324.,  729.],
#:&gt;        [   5.,   10.,   25.,   50.,  100.,  125.,  250.,  500., 1000.]])</code></pre>
</div>
</div>
</div>
<div id="imputation-of-missing-data" class="section level2" number="16.9">
<h2>
<span class="header-section-number">16.9</span> Imputation of Missing Data<a class="anchor" aria-label="anchor" href="#imputation-of-missing-data"><i class="fas fa-link"></i></a>
</h2>
<div id="sample-data-23" class="section level3" number="16.9.1">
<h3>
<span class="header-section-number">16.9.1</span> Sample Data<a class="anchor" aria-label="anchor" href="#sample-data-23"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1664"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1664-1"><a href="sklearn.html#cb1664-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> nan</span>
<span id="cb1664-2"><a href="sklearn.html#cb1664-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([[ nan, <span class="dv">0</span>,   <span class="dv">3</span>  ],</span>
<span id="cb1664-3"><a href="sklearn.html#cb1664-3" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">3</span>,   <span class="dv">7</span>,   <span class="dv">9</span>  ],</span>
<span id="cb1664-4"><a href="sklearn.html#cb1664-4" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">3</span>,   <span class="dv">5</span>,   <span class="dv">2</span>  ],</span>
<span id="cb1664-5"><a href="sklearn.html#cb1664-5" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">4</span>,   nan, <span class="dv">6</span>  ],</span>
<span id="cb1664-6"><a href="sklearn.html#cb1664-6" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">8</span>,   <span class="dv">8</span>,   <span class="dv">1</span>  ]])</span>
<span id="cb1664-7"><a href="sklearn.html#cb1664-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1664-8"><a href="sklearn.html#cb1664-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">14</span>, <span class="dv">16</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">8</span>, <span class="op">-</span><span class="dv">5</span>])</span></code></pre></div>
</div>
<div id="imputer" class="section level3" number="16.9.2">
<h3>
<span class="header-section-number">16.9.2</span> Imputer<a class="anchor" aria-label="anchor" href="#imputer"><i class="fas fa-link"></i></a>
</h3>
<div id="mean-strategy" class="section level4" number="16.9.2.1">
<h4>
<span class="header-section-number">16.9.2.1</span> mean strategy<a class="anchor" aria-label="anchor" href="#mean-strategy"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1665"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1665-1"><a href="sklearn.html#cb1665-1" aria-hidden="true" tabindex="-1"></a>imp <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb1665-2"><a href="sklearn.html#cb1665-2" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> imp.fit_transform(X)</span>
<span id="cb1665-3"><a href="sklearn.html#cb1665-3" aria-hidden="true" tabindex="-1"></a>X2</span></code></pre></div>
<pre><code>#:&gt; array([[4.5, 0. , 3. ],
#:&gt;        [3. , 7. , 9. ],
#:&gt;        [3. , 5. , 2. ],
#:&gt;        [4. , 5. , 6. ],
#:&gt;        [8. , 8. , 1. ]])</code></pre>
</div>
</div>
</div>
<div id="scaling" class="section level2" number="16.10">
<h2>
<span class="header-section-number">16.10</span> Scaling<a class="anchor" aria-label="anchor" href="#scaling"><i class="fas fa-link"></i></a>
</h2>
<p>It is possible that some insignificant variable with larger range will be dominating the objective function.<br>
We can remove this problem by scaling down all the features to a same range.</p>
<div id="sample-data-24" class="section level3" number="16.10.1">
<h3>
<span class="header-section-number">16.10.1</span> Sample Data<a class="anchor" aria-label="anchor" href="#sample-data-24"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1667"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1667-1"><a href="sklearn.html#cb1667-1" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>mydf.<span class="bu">filter</span>(like<span class="op">=</span><span class="st">'x'</span>)[:<span class="dv">5</span>]</span>
<span id="cb1667-2"><a href="sklearn.html#cb1667-2" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>#:&gt;    x1  x2  x3
#:&gt; 0   4  17   8
#:&gt; 1   3  12   7
#:&gt; 2  10  10   8
#:&gt; 3  20  18   8
#:&gt; 4  20   6  14</code></pre>
</div>
<div id="minmax-scaler" class="section level3" number="16.10.2">
<h3>
<span class="header-section-number">16.10.2</span> MinMax Scaler<a class="anchor" aria-label="anchor" href="#minmax-scaler"><i class="fas fa-link"></i></a>
</h3>
<pre><code>MinMaxScaler( feature_range(0,1), copy=True )
# default feature range (output result) from 0 to 1
# default return a copy of new array, copy=False will inplace original array</code></pre>
<p><strong>Define Scaler Object</strong></p>
<div class="sourceCode" id="cb1670"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1670-1"><a href="sklearn.html#cb1670-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span></code></pre></div>
<p><strong>Transform Data</strong></p>
<div class="sourceCode" id="cb1671"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1671-1"><a href="sklearn.html#cb1671-1" aria-hidden="true" tabindex="-1"></a>scaler.fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[0.05882353, 0.91666667, 0.14285714],
#:&gt;        [0.        , 0.5       , 0.        ],
#:&gt;        [0.41176471, 0.33333333, 0.14285714],
#:&gt;        [1.        , 1.        , 0.14285714],
#:&gt;        [1.        , 0.        , 1.        ]])</code></pre>
<p><strong>Scaler Attributes</strong></p>
<pre><code>data_min_: minimum value of the feature (before scaling)  
data_max_: maximum value of the feature (before scaling)  </code></pre>
<div class="sourceCode" id="cb1674"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1674-1"><a href="sklearn.html#cb1674-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(<span class="bu">list</span>(<span class="bu">zip</span>(scaler.data_min_, scaler.data_max_)), </span>
<span id="cb1674-2"><a href="sklearn.html#cb1674-2" aria-hidden="true" tabindex="-1"></a>             columns<span class="op">=</span>[<span class="st">'data_min'</span>,<span class="st">'data_max'</span>], </span>
<span id="cb1674-3"><a href="sklearn.html#cb1674-3" aria-hidden="true" tabindex="-1"></a>             index<span class="op">=</span>X.columns)</span></code></pre></div>
<pre><code>#:&gt;     data_min  data_max
#:&gt; x1       3.0      20.0
#:&gt; x2       6.0      18.0
#:&gt; x3       7.0      14.0</code></pre>
</div>
<div id="standard-scaler" class="section level3" number="16.10.3">
<h3>
<span class="header-section-number">16.10.3</span> Standard Scaler<a class="anchor" aria-label="anchor" href="#standard-scaler"><i class="fas fa-link"></i></a>
</h3>
<p>It is most suitable for techniques that assume a Gaussian distribution in the input variables and work better with rescaled data, such as linear regression, logistic regression and linear discriminate analysis.</p>
<pre><code>StandardScaler(copy=True, with_mean=True, with_std=True)
# copy=True : return a copy of data, instead of inplace
# with_mean=True : centre all features by substracting with its mean
# with_std=True  : centre all features by dividing with its std</code></pre>
<p><strong>Define Scaler Object</strong></p>
<div class="sourceCode" id="cb1677"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1677-1"><a href="sklearn.html#cb1677-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span></code></pre></div>
<p><strong>Transform Data</strong></p>
<div class="sourceCode" id="cb1678"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1678-1"><a href="sklearn.html#cb1678-1" aria-hidden="true" tabindex="-1"></a>scaler.fit_transform(X)</span></code></pre></div>
<pre><code>#:&gt; array([[-0.99745315,  0.98782916, -0.39528471],
#:&gt;        [-1.13224412, -0.13470398, -0.79056942],
#:&gt;        [-0.18870735, -0.58371723, -0.39528471],
#:&gt;        [ 1.15920231,  1.21233579, -0.39528471],
#:&gt;        [ 1.15920231, -1.48174374,  1.97642354]])</code></pre>
<p><strong>Scaler Attributes</strong><br>
After the data transformation step above, scaler will have the mean and variance information for each feature.</p>
<div class="sourceCode" id="cb1680"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1680-1"><a href="sklearn.html#cb1680-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(<span class="bu">list</span>(<span class="bu">zip</span>(scaler.mean_, scaler.var_)), </span>
<span id="cb1680-2"><a href="sklearn.html#cb1680-2" aria-hidden="true" tabindex="-1"></a>             columns<span class="op">=</span>[<span class="st">'mean'</span>,<span class="st">'variance'</span>], </span>
<span id="cb1680-3"><a href="sklearn.html#cb1680-3" aria-hidden="true" tabindex="-1"></a>             index<span class="op">=</span>X.columns)</span></code></pre></div>
<pre><code>#:&gt;     mean  variance
#:&gt; x1  11.4     55.04
#:&gt; x2  12.6     19.84
#:&gt; x3   9.0      6.40</code></pre>
</div>
</div>
<div id="pipeline" class="section level2" number="16.11">
<h2>
<span class="header-section-number">16.11</span> Pipeline<a class="anchor" aria-label="anchor" href="#pipeline"><i class="fas fa-link"></i></a>
</h2>
<p>With any of the preceding examples, it can quickly become tedious to do the transformations by hand, especially if you wish to string together multiple steps. For example, we might want a processing pipeline that looks something like this:</p>
<ul>
<li>
<strong>Impute</strong> missing values using the mean<br>
</li>
<li>
<strong>Transform</strong> features to quadratic<br>
</li>
<li>
<strong>Fit</strong> a linear regression</li>
</ul>
<p><strong>make_pipeline</strong> takes list of functions as parameters. When calling <strong>fit()</strong> on a pipeline object, these functions will be performed in sequential with data flow from one function to another.</p>
<pre><code>make_pipeline (
    function_1 (),
    function_2 (),
    function_3 ()
 )</code></pre>
<div id="sample-data-25" class="section level3" number="16.11.1">
<h3>
<span class="header-section-number">16.11.1</span> Sample Data<a class="anchor" aria-label="anchor" href="#sample-data-25"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1683"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1683-1"><a href="sklearn.html#cb1683-1" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>#:&gt;    x1  x2  x3
#:&gt; 0   4  17   8
#:&gt; 1   3  12   7
#:&gt; 2  10  10   8
#:&gt; 3  20  18   8
#:&gt; 4  20   6  14</code></pre>
<div class="sourceCode" id="cb1685"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1685-1"><a href="sklearn.html#cb1685-1" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>#:&gt; array([14, 16, -1,  8, -5])</code></pre>
</div>
<div id="create-pipeline" class="section level3" number="16.11.2">
<h3>
<span class="header-section-number">16.11.2</span> Create Pipeline<a class="anchor" aria-label="anchor" href="#create-pipeline"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1687"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1687-1"><a href="sklearn.html#cb1687-1" aria-hidden="true" tabindex="-1"></a>my_pipe <span class="op">=</span> make_pipeline (</span>
<span id="cb1687-2"><a href="sklearn.html#cb1687-2" aria-hidden="true" tabindex="-1"></a>    SimpleImputer            (strategy<span class="op">=</span><span class="st">'mean'</span>),</span>
<span id="cb1687-3"><a href="sklearn.html#cb1687-3" aria-hidden="true" tabindex="-1"></a>    PolynomialFeatures (degree<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb1687-4"><a href="sklearn.html#cb1687-4" aria-hidden="true" tabindex="-1"></a>    LinearRegression   ()</span>
<span id="cb1687-5"><a href="sklearn.html#cb1687-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1687-6"><a href="sklearn.html#cb1687-6" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(my_pipe)</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'sklearn.pipeline.Pipeline'&gt;</code></pre>
<div class="sourceCode" id="cb1689"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1689-1"><a href="sklearn.html#cb1689-1" aria-hidden="true" tabindex="-1"></a>my_pipe</span></code></pre></div>
<pre><code>#:&gt; Pipeline(steps=[('simpleimputer', SimpleImputer()),
#:&gt;                 ('polynomialfeatures', PolynomialFeatures()),
#:&gt;                 ('linearregression', LinearRegression())])</code></pre>
</div>
<div id="executing-pipeline" class="section level3" number="16.11.3">
<h3>
<span class="header-section-number">16.11.3</span> Executing Pipeline<a class="anchor" aria-label="anchor" href="#executing-pipeline"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1691"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1691-1"><a href="sklearn.html#cb1691-1" aria-hidden="true" tabindex="-1"></a>my_pipe.fit( X, y) <span class="co"># execute the pipeline</span></span></code></pre></div>
<pre><code>#:&gt; Pipeline(steps=[('simpleimputer', SimpleImputer()),
#:&gt;                 ('polynomialfeatures', PolynomialFeatures()),
#:&gt;                 ('linearregression', LinearRegression())])</code></pre>
<div class="sourceCode" id="cb1693"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1693-1"><a href="sklearn.html#cb1693-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (y)</span></code></pre></div>
<pre><code>#:&gt; [14 16 -1  8 -5]</code></pre>
<div class="sourceCode" id="cb1695"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1695-1"><a href="sklearn.html#cb1695-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (my_pipe.predict(X))</span></code></pre></div>
<pre><code>#:&gt; [14. 16. -1.  8. -5.]</code></pre>
<div class="sourceCode" id="cb1697"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1697-1"><a href="sklearn.html#cb1697-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(my_pipe)</span></code></pre></div>
<pre><code>#:&gt; &lt;class 'sklearn.pipeline.Pipeline'&gt;</code></pre>
</div>
</div>
<div id="cross-validation" class="section level2" number="16.12">
<h2>
<span class="header-section-number">16.12</span> Cross Validation<a class="anchor" aria-label="anchor" href="#cross-validation"><i class="fas fa-link"></i></a>
</h2>
<div id="load-data" class="section level3" number="16.12.1">
<h3>
<span class="header-section-number">16.12.1</span> Load Data<a class="anchor" aria-label="anchor" href="#load-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1699"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1699-1"><a href="sklearn.html#cb1699-1" aria-hidden="true" tabindex="-1"></a>X,y <span class="op">=</span> datasets.load_diabetes(return_X_y<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div id="choose-an-cross-validator" class="section level3" number="16.12.2">
<h3>
<span class="header-section-number">16.12.2</span> Choose An Cross Validator<a class="anchor" aria-label="anchor" href="#choose-an-cross-validator"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1700"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1700-1"><a href="sklearn.html#cb1700-1" aria-hidden="true" tabindex="-1"></a>kf <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>)</span></code></pre></div>
</div>
<div id="run-cross-validation" class="section level3" number="16.12.3">
<h3>
<span class="header-section-number">16.12.3</span> Run Cross Validation<a class="anchor" aria-label="anchor" href="#run-cross-validation"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Single Scorer</strong><br>
Use default scorer of the estimator (if available)</p>
<div class="sourceCode" id="cb1701"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1701-1"><a href="sklearn.html#cb1701-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso()</span>
<span id="cb1701-2"><a href="sklearn.html#cb1701-2" aria-hidden="true" tabindex="-1"></a>cv_results1 <span class="op">=</span> cross_validate(lasso, X,y,cv<span class="op">=</span>kf,</span>
<span id="cb1701-3"><a href="sklearn.html#cb1701-3" aria-hidden="true" tabindex="-1"></a>    return_train_score<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p><strong>Multiple Scorer</strong><br>
Specify the scorer
<a href="http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter" class="uri">http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</a></p>
<div class="sourceCode" id="cb1702"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1702-1"><a href="sklearn.html#cb1702-1" aria-hidden="true" tabindex="-1"></a>cv_results2 <span class="op">=</span> cross_validate(lasso, X,y,cv<span class="op">=</span>kf,</span>
<span id="cb1702-2"><a href="sklearn.html#cb1702-2" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span>(<span class="st">"neg_mean_absolute_error"</span>,<span class="st">"neg_mean_squared_error"</span>,<span class="st">"r2"</span>),</span>
<span id="cb1702-3"><a href="sklearn.html#cb1702-3" aria-hidden="true" tabindex="-1"></a>    return_train_score<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div id="the-result" class="section level3" number="16.12.4">
<h3>
<span class="header-section-number">16.12.4</span> The Result<a class="anchor" aria-label="anchor" href="#the-result"><i class="fas fa-link"></i></a>
</h3>
<p>Result is a <strong>dictionary</strong></p>
<div class="sourceCode" id="cb1703"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1703-1"><a href="sklearn.html#cb1703-1" aria-hidden="true" tabindex="-1"></a>cv_results1.keys()</span></code></pre></div>
<pre><code>#:&gt; dict_keys(['fit_time', 'score_time', 'test_score'])</code></pre>
<div class="sourceCode" id="cb1705"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1705-1"><a href="sklearn.html#cb1705-1" aria-hidden="true" tabindex="-1"></a>cv_results2.keys()</span></code></pre></div>
<pre><code>#:&gt; dict_keys(['fit_time', 'score_time', 'test_neg_mean_absolute_error', 'test_neg_mean_squared_error', 'test_r2'])</code></pre>
<div class="sourceCode" id="cb1707"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1707-1"><a href="sklearn.html#cb1707-1" aria-hidden="true" tabindex="-1"></a>cv_results1</span></code></pre></div>
<pre><code>#:&gt; {'fit_time': array([0.00172329, 0.0009141 , 0.00079846, 0.0021131 , 0.00171661]), 'score_time': array([0.0008173 , 0.00063205, 0.00058079, 0.00156474, 0.000808  ]), 'test_score': array([0.28349047, 0.35157959, 0.3533813 , 0.33481474, 0.36453281])}</code></pre>
<div class="sourceCode" id="cb1709"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1709-1"><a href="sklearn.html#cb1709-1" aria-hidden="true" tabindex="-1"></a>cv_results2</span></code></pre></div>
<pre><code>#:&gt; {'fit_time': array([0.00099969, 0.00148869, 0.0009346 , 0.00071526, 0.00097752]), 'score_time': array([0.00457335, 0.00144625, 0.00123525, 0.00114274, 0.00107718]), 'test_neg_mean_absolute_error': array([-50.09003423, -52.54110842, -55.02813846, -50.81121806,
#:&gt;        -55.60471593]), 'test_neg_mean_squared_error': array([-3491.74009759, -4113.86002091, -4046.91780932, -3489.74018715,
#:&gt;        -4111.92401769]), 'test_r2': array([0.28349047, 0.35157959, 0.3533813 , 0.33481474, 0.36453281])}</code></pre>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="seaborn.html"><span class="header-section-number">15</span> seaborn</a></div>
<div class="next"><a href="nlp.html"><span class="header-section-number">17</span> NLP</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#sklearn"><span class="header-section-number">16</span> sklearn</a></li>
<li><a class="nav-link" href="#setup-hidden"><span class="header-section-number">16.1</span> Setup (hidden)</a></li>
<li><a class="nav-link" href="#the-library"><span class="header-section-number">16.2</span> The Library</a></li>
<li>
<a class="nav-link" href="#model-fitting"><span class="header-section-number">16.3</span> Model Fitting</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#underfitting"><span class="header-section-number">16.3.1</span> Underfitting</a></li>
<li><a class="nav-link" href="#overfitting"><span class="header-section-number">16.3.2</span> Overfitting</a></li>
<li><a class="nav-link" href="#just-right"><span class="header-section-number">16.3.3</span> Just Right</a></li>
</ul>
</li>
<li><a class="nav-link" href="#model-tuning"><span class="header-section-number">16.4</span> Model Tuning</a></li>
<li><a class="nav-link" href="#high-level-ml-process"><span class="header-section-number">16.5</span> High Level ML Process</a></li>
<li>
<a class="nav-link" href="#built-in-datasets"><span class="header-section-number">16.6</span> Built-in Datasets</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#diabetes-regression"><span class="header-section-number">16.6.1</span> diabetes (regression)</a></li>
<li><a class="nav-link" href="#digits-classification"><span class="header-section-number">16.6.2</span> digits (Classification)</a></li>
<li><a class="nav-link" href="#iris-classification"><span class="header-section-number">16.6.3</span> iris (Classification)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#train-test-data-splitting"><span class="header-section-number">16.7</span> Train Test Data Splitting</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sample-data-20"><span class="header-section-number">16.7.1</span> Sample Data</a></li>
<li><a class="nav-link" href="#one-time-split"><span class="header-section-number">16.7.2</span> One Time Split</a></li>
<li><a class="nav-link" href="#k-fold"><span class="header-section-number">16.7.3</span> K-Fold</a></li>
<li><a class="nav-link" href="#leave-one-out"><span class="header-section-number">16.7.4</span> Leave One Out</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#polynomial-transform"><span class="header-section-number">16.8</span> Polynomial Transform</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#single-variable"><span class="header-section-number">16.8.1</span> Single Variable</a></li>
<li><a class="nav-link" href="#two-variables"><span class="header-section-number">16.8.2</span> Two Variables</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#imputation-of-missing-data"><span class="header-section-number">16.9</span> Imputation of Missing Data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sample-data-23"><span class="header-section-number">16.9.1</span> Sample Data</a></li>
<li><a class="nav-link" href="#imputer"><span class="header-section-number">16.9.2</span> Imputer</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#scaling"><span class="header-section-number">16.10</span> Scaling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sample-data-24"><span class="header-section-number">16.10.1</span> Sample Data</a></li>
<li><a class="nav-link" href="#minmax-scaler"><span class="header-section-number">16.10.2</span> MinMax Scaler</a></li>
<li><a class="nav-link" href="#standard-scaler"><span class="header-section-number">16.10.3</span> Standard Scaler</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#pipeline"><span class="header-section-number">16.11</span> Pipeline</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sample-data-25"><span class="header-section-number">16.11.1</span> Sample Data</a></li>
<li><a class="nav-link" href="#create-pipeline"><span class="header-section-number">16.11.2</span> Create Pipeline</a></li>
<li><a class="nav-link" href="#executing-pipeline"><span class="header-section-number">16.11.3</span> Executing Pipeline</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#cross-validation"><span class="header-section-number">16.12</span> Cross Validation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#load-data"><span class="header-section-number">16.12.1</span> Load Data</a></li>
<li><a class="nav-link" href="#choose-an-cross-validator"><span class="header-section-number">16.12.2</span> Choose An Cross Validator</a></li>
<li><a class="nav-link" href="#run-cross-validation"><span class="header-section-number">16.12.3</span> Run Cross Validation</a></li>
<li><a class="nav-link" href="#the-result"><span class="header-section-number">16.12.4</span> The Result</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com//f0nzie/yongks-python-rmarkdown-book/blob/master/05-sklearn.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com//f0nzie/yongks-python-rmarkdown-book/edit/master/05-sklearn.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Python Bookdown</strong>" was written by Yong Keh Soon. It was last built on 2020-12-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
